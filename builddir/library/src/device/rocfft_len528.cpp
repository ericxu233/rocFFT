/*
 * Stockham kernels generated by:
 * 
 *     /home/ugrad/ugrad003/roctosycl/rocFFT/library/src/device/kernel-generator.py --pattern=all --precision=all --groups=150 --manual-small= --manual-large= generate /home/ugrad/ugrad003/roctosycl/rocFFT/builddir/library/src/device/generator/rocfft-kernel-generator
 * 
 * Generator is: /home/ugrad/ugrad003/roctosycl/rocFFT/library/src/device/kernel-generator.py
 * Kernel is: namespace(factors=[4, 4, 3, 11], flavour='wide', length=528, scheme='CS_KERNEL_STOCKHAM', threads_per_block=64)
 */

#include "kernel_launch.h"
#include "real2complex.h"
#include "rocfft_butterfly_template.h"
#include <hip/hip_runtime.h>

/* stockham.py:843 */
template <typename scalar_type, StrideBin sb>
__device__ void ip_forward_length528_SBRR_device(scalar_type* __restrict__ lds,
                                                 const scalar_type* __restrict__ twiddles,
                                                 size_t       stride_lds,
                                                 unsigned int offset_lds,
                                                 bool         write)
{
    size_t       thread;
    scalar_type  R[22];
    scalar_type  W;
    scalar_type  t;
    const size_t lstride = (sb == SB_UNIT) ? (1) : (stride_lds);

    __syncthreads();

    // pass 0
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    FwdRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    FwdRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        FwdRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 1
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        W     = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
        t.y   = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
        R[9]  = t; /* stockham.py:557 */
        W     = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    FwdRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    FwdRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        FwdRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 2
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[3]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    R[6]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        R[9]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        W     = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    FwdRad3B1(&R[0], &R[1], &R[2]); /* stockham.py:566 */

    FwdRad3B1(&R[3], &R[4], &R[5]); /* stockham.py:566 */

    FwdRad3B1(&R[6], &R[7], &R[8]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 144 < 176)
    {
        FwdRad3B1(&R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[2]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[5]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[8]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 144 < 176))
    {
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 3
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 48) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 96) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 144) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 192) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 240) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 288) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 336) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 384) * lstride]; /* stockham.py:542 */
    R[9]   = lds[offset_lds + (thread + 432) * lstride]; /* stockham.py:542 */
    R[10]  = lds[offset_lds + (thread + 480) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[47 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[48 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = twiddles[49 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */
    W      = twiddles[50 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = twiddles[51 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = twiddles[52 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = twiddles[53 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = twiddles[54 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */
    W      = twiddles[55 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
    t.y    = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
    R[9]   = t; /* stockham.py:557 */
    W      = twiddles[56 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
    t.y    = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
    R[10]  = t; /* stockham.py:557 */

    FwdRad11B1(&R[0],
               &R[1],
               &R[2],
               &R[3],
               &R[4],
               &R[5],
               &R[6],
               &R[7],
               &R[8],
               &R[9],
               &R[10]); /* stockham.py:566 */

    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 48) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 96) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 144) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 192) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 240) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 288) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 336) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 384) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 432) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 480) * lstride]
            = R[10]; /* stockham.py:577 */
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__
    __launch_bounds__(48) void ip_forward_length528_SBRR(const scalar_type* __restrict__ twiddles,
                                                         const size_t dim,
                                                         const size_t* __restrict__ lengths,
                                                         const size_t* __restrict__ stride,
                                                         const size_t       nbatch,
                                                         const unsigned int lds_padding,
                                                         void* __restrict__ load_cb_fn,
                                                         void* __restrict__ load_cb_data,
                                                         uint32_t load_cb_lds_bytes,
                                                         void* __restrict__ store_cb_fn,
                                                         void* __restrict__ store_cb_data,
                                                         scalar_type* __restrict__ buf)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset           = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0  = (sb == SB_UNIT) ? (1) : (stride[0]);
    auto         load_cb  = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset        = offset + index_along_d * stride[d]; /* stockham.py:370 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset     = offset + batch * stride[dim]; /* stockham.py:372 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf, offset + (thread + 0) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf, offset + (thread + 48) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf, offset + (thread + 96) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf, offset + (thread + 144) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf, offset + (thread + 192) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf, offset + (thread + 240) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf, offset + (thread + 288) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf, offset + (thread + 336) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf, offset + (thread + 384) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf, offset + (thread + 432) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf, offset + (thread + 480) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = load_cb(buf, offset + (thread + 480 + 1) * stride0, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    ip_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(
        buf, offset + (thread + 0) * stride0, lds[offset_lds + thread + 0], store_cb_data, nullptr);
    store_cb(buf,
             offset + (thread + 48) * stride0,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 96) * stride0,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 144) * stride0,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 192) * stride0,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 240) * stride0,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 288) * stride0,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 336) * stride0,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 384) * stride0,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 432) * stride0,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 480) * stride0,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf,
                     offset + (thread + 480 + 1) * stride0,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void ip_forward_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ bufre,
    real_type_t<scalar_type>* __restrict__ bufim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset           = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0  = (sb == SB_UNIT) ? (1) : (stride[0]);
    auto         load_cb  = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset        = offset + index_along_d * stride[d]; /* stockham.py:370 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset     = offset + batch * stride[dim]; /* stockham.py:372 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread                       = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0] = {bufre[offset + (thread + 0) * stride0],
                                    bufim[offset + (thread + 0) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {bufre[offset + (thread + 48) * stride0],
           bufim[offset + (thread + 48) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {bufre[offset + (thread + 96) * stride0],
           bufim[offset + (thread + 96) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {bufre[offset + (thread + 144) * stride0],
           bufim[offset + (thread + 144) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {bufre[offset + (thread + 192) * stride0],
           bufim[offset + (thread + 192) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {bufre[offset + (thread + 240) * stride0],
           bufim[offset + (thread + 240) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {bufre[offset + (thread + 288) * stride0],
           bufim[offset + (thread + 288) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {bufre[offset + (thread + 336) * stride0],
           bufim[offset + (thread + 336) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {bufre[offset + (thread + 384) * stride0],
           bufim[offset + (thread + 384) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {bufre[offset + (thread + 432) * stride0],
           bufim[offset + (thread + 432) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {bufre[offset + (thread + 480) * stride0],
           bufim[offset + (thread + 480) * stride0]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {bufre[offset + (thread + 480 + 1) * stride0],
                   bufim[offset + (thread + 480 + 1) * stride0]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    ip_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    bufre[offset + (thread + 0) * stride0] = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    bufim[offset + (thread + 0) * stride0] = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    bufre[offset + (thread + 48) * stride0]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    bufim[offset + (thread + 48) * stride0]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    bufre[offset + (thread + 96) * stride0]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    bufim[offset + (thread + 96) * stride0]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    bufre[offset + (thread + 144) * stride0]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    bufim[offset + (thread + 144) * stride0]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    bufre[offset + (thread + 192) * stride0]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    bufim[offset + (thread + 192) * stride0]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    bufre[offset + (thread + 240) * stride0]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    bufim[offset + (thread + 240) * stride0]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    bufre[offset + (thread + 288) * stride0]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    bufim[offset + (thread + 288) * stride0]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    bufre[offset + (thread + 336) * stride0]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    bufim[offset + (thread + 336) * stride0]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    bufre[offset + (thread + 384) * stride0]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    bufim[offset + (thread + 384) * stride0]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    bufre[offset + (thread + 432) * stride0]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    bufim[offset + (thread + 432) * stride0]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    bufre[offset + (thread + 480) * stride0]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    bufim[offset + (thread + 480) * stride0]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            bufre[offset + (thread + 480 + 1) * stride0]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            bufim[offset + (thread + 480 + 1) * stride0]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
/* stockham.py:843 */
template <typename scalar_type, StrideBin sb>
__device__ void op_forward_length528_SBRR_device(scalar_type* __restrict__ lds,
                                                 const scalar_type* __restrict__ twiddles,
                                                 size_t       stride_lds,
                                                 unsigned int offset_lds,
                                                 bool         write)
{
    size_t       thread;
    scalar_type  R[22];
    scalar_type  W;
    scalar_type  t;
    const size_t lstride = (sb == SB_UNIT) ? (1) : (stride_lds);

    __syncthreads();

    // pass 0
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    FwdRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    FwdRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        FwdRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 1
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        W     = twiddles[3 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
        t.y   = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
        R[9]  = t; /* stockham.py:557 */
        W     = twiddles[4 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = twiddles[5 + 3 * (thread % 4)]; /* stockham.py:554 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    FwdRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    FwdRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        FwdRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 2
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[3]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    R[6]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        R[9]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    W      = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        W     = twiddles[15 + 2 * (thread % 16)]; /* stockham.py:554 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = twiddles[16 + 2 * (thread % 16)]; /* stockham.py:554 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    FwdRad3B1(&R[0], &R[1], &R[2]); /* stockham.py:566 */

    FwdRad3B1(&R[3], &R[4], &R[5]); /* stockham.py:566 */

    FwdRad3B1(&R[6], &R[7], &R[8]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 144 < 176)
    {
        FwdRad3B1(&R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[2]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[5]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[8]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 144 < 176))
    {
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 3
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 48) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 96) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 144) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 192) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 240) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 288) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 336) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 384) * lstride]; /* stockham.py:542 */
    R[9]   = lds[offset_lds + (thread + 432) * lstride]; /* stockham.py:542 */
    R[10]  = lds[offset_lds + (thread + 480) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = twiddles[47 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = twiddles[48 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = twiddles[49 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */
    W      = twiddles[50 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = twiddles[51 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = twiddles[52 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = twiddles[53 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = twiddles[54 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */
    W      = twiddles[55 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
    t.y    = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
    R[9]   = t; /* stockham.py:557 */
    W      = twiddles[56 + 10 * (thread % 48)]; /* stockham.py:554 */
    t.x    = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
    t.y    = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
    R[10]  = t; /* stockham.py:557 */

    FwdRad11B1(&R[0],
               &R[1],
               &R[2],
               &R[3],
               &R[4],
               &R[5],
               &R[6],
               &R[7],
               &R[8],
               &R[9],
               &R[10]); /* stockham.py:566 */

    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 48) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 96) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 144) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 192) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 240) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 288) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 336) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 384) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 432) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 480) * lstride]
            = R[10]; /* stockham.py:577 */
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__
    __launch_bounds__(48) void op_forward_length528_SBRR(const scalar_type* __restrict__ twiddles,
                                                         const size_t dim,
                                                         const size_t* __restrict__ lengths,
                                                         const size_t* __restrict__ stride_in,
                                                         const size_t* __restrict__ stride_out,
                                                         const size_t       nbatch,
                                                         const unsigned int lds_padding,
                                                         void* __restrict__ load_cb_fn,
                                                         void* __restrict__ load_cb_data,
                                                         uint32_t load_cb_lds_bytes,
                                                         void* __restrict__ store_cb_fn,
                                                         void* __restrict__ store_cb_data,
                                                         scalar_type* __restrict__ buf_in,
                                                         scalar_type* __restrict__ buf_out)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf_in, offset_in + (thread + 0) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf_in, offset_in + (thread + 48) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf_in, offset_in + (thread + 96) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf_in, offset_in + (thread + 144) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf_in, offset_in + (thread + 192) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf_in, offset_in + (thread + 240) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf_in, offset_in + (thread + 288) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf_in, offset_in + (thread + 336) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf_in, offset_in + (thread + 384) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf_in, offset_in + (thread + 432) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf_in, offset_in + (thread + 480) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1] = load_cb(
                buf_in, offset_in + (thread + 480 + 1) * stride0_in, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(buf_out,
             offset_out + (thread + 0) * stride0_out,
             lds[offset_lds + thread + 0],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 48) * stride0_out,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 96) * stride0_out,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 144) * stride0_out,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 192) * stride0_out,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 240) * stride0_out,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 288) * stride0_out,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 336) * stride0_out,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 384) * stride0_out,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 432) * stride0_out,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 480) * stride0_out,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf_out,
                     offset_out + (thread + 480 + 1) * stride0_out,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_forward_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    scalar_type* __restrict__ buf_in,
    real_type_t<scalar_type>* __restrict__ buf_outre,
    real_type_t<scalar_type>* __restrict__ buf_outim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf_in, offset_in + (thread + 0) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf_in, offset_in + (thread + 48) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf_in, offset_in + (thread + 96) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf_in, offset_in + (thread + 144) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf_in, offset_in + (thread + 192) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf_in, offset_in + (thread + 240) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf_in, offset_in + (thread + 288) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf_in, offset_in + (thread + 336) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf_in, offset_in + (thread + 384) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf_in, offset_in + (thread + 432) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf_in, offset_in + (thread + 480) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1] = load_cb(
                buf_in, offset_in + (thread + 480 + 1) * stride0_in, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    buf_outre[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            buf_outre[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            buf_outim[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_forward_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ buf_inre,
    real_type_t<scalar_type>* __restrict__ buf_inim,
    scalar_type* __restrict__ buf_out)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = {buf_inre[offset_in + (thread + 0) * stride0_in],
           buf_inim[offset_in + (thread + 0) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {buf_inre[offset_in + (thread + 48) * stride0_in],
           buf_inim[offset_in + (thread + 48) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {buf_inre[offset_in + (thread + 96) * stride0_in],
           buf_inim[offset_in + (thread + 96) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {buf_inre[offset_in + (thread + 144) * stride0_in],
           buf_inim[offset_in + (thread + 144) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {buf_inre[offset_in + (thread + 192) * stride0_in],
           buf_inim[offset_in + (thread + 192) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {buf_inre[offset_in + (thread + 240) * stride0_in],
           buf_inim[offset_in + (thread + 240) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {buf_inre[offset_in + (thread + 288) * stride0_in],
           buf_inim[offset_in + (thread + 288) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {buf_inre[offset_in + (thread + 336) * stride0_in],
           buf_inim[offset_in + (thread + 336) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {buf_inre[offset_in + (thread + 384) * stride0_in],
           buf_inim[offset_in + (thread + 384) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {buf_inre[offset_in + (thread + 432) * stride0_in],
           buf_inim[offset_in + (thread + 432) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {buf_inre[offset_in + (thread + 480) * stride0_in],
           buf_inim[offset_in + (thread + 480) * stride0_in]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {buf_inre[offset_in + (thread + 480 + 1) * stride0_in],
                   buf_inim[offset_in + (thread + 480 + 1) * stride0_in]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(buf_out,
             offset_out + (thread + 0) * stride0_out,
             lds[offset_lds + thread + 0],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 48) * stride0_out,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 96) * stride0_out,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 144) * stride0_out,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 192) * stride0_out,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 240) * stride0_out,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 288) * stride0_out,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 336) * stride0_out,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 384) * stride0_out,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 432) * stride0_out,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 480) * stride0_out,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf_out,
                     offset_out + (thread + 480 + 1) * stride0_out,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_forward_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ buf_inre,
    real_type_t<scalar_type>* __restrict__ buf_inim,
    real_type_t<scalar_type>* __restrict__ buf_outre,
    real_type_t<scalar_type>* __restrict__ buf_outim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = {buf_inre[offset_in + (thread + 0) * stride0_in],
           buf_inim[offset_in + (thread + 0) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {buf_inre[offset_in + (thread + 48) * stride0_in],
           buf_inim[offset_in + (thread + 48) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {buf_inre[offset_in + (thread + 96) * stride0_in],
           buf_inim[offset_in + (thread + 96) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {buf_inre[offset_in + (thread + 144) * stride0_in],
           buf_inim[offset_in + (thread + 144) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {buf_inre[offset_in + (thread + 192) * stride0_in],
           buf_inim[offset_in + (thread + 192) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {buf_inre[offset_in + (thread + 240) * stride0_in],
           buf_inim[offset_in + (thread + 240) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {buf_inre[offset_in + (thread + 288) * stride0_in],
           buf_inim[offset_in + (thread + 288) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {buf_inre[offset_in + (thread + 336) * stride0_in],
           buf_inim[offset_in + (thread + 336) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {buf_inre[offset_in + (thread + 384) * stride0_in],
           buf_inim[offset_in + (thread + 384) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {buf_inre[offset_in + (thread + 432) * stride0_in],
           buf_inim[offset_in + (thread + 432) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {buf_inre[offset_in + (thread + 480) * stride0_in],
           buf_inim[offset_in + (thread + 480) * stride0_in]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {buf_inre[offset_in + (thread + 480 + 1) * stride0_in],
                   buf_inim[offset_in + (thread + 480 + 1) * stride0_in]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_forward_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    buf_outre[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            buf_outre[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            buf_outim[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
/* stockham.py:843 */
template <typename scalar_type, StrideBin sb>
__device__ void ip_inverse_length528_SBRR_device(scalar_type* __restrict__ lds,
                                                 const scalar_type* __restrict__ twiddles,
                                                 size_t       stride_lds,
                                                 unsigned int offset_lds,
                                                 bool         write)
{
    size_t       thread;
    scalar_type  R[22];
    scalar_type  W;
    scalar_type  t;
    const size_t lstride = (sb == SB_UNIT) ? (1) : (stride_lds);

    __syncthreads();

    // pass 0
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    InvRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    InvRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        InvRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 1
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[3 + 3 * (thread % 4)].x,
         -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[4 + 3 * (thread % 4)].x,
         -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = {twiddles[5 + 3 * (thread % 4)].x,
         -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = {twiddles[3 + 3 * (thread % 4)].x,
         -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = {twiddles[4 + 3 * (thread % 4)].x,
         -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = {twiddles[5 + 3 * (thread % 4)].x,
         -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        W     = {twiddles[3 + 3 * (thread % 4)].x,
             -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
        t.y   = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
        R[9]  = t; /* stockham.py:557 */
        W     = {twiddles[4 + 3 * (thread % 4)].x,
             -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = {twiddles[5 + 3 * (thread % 4)].x,
             -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    InvRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    InvRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        InvRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 2
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[3]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    R[6]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        R[9]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        W     = {twiddles[15 + 2 * (thread % 16)].x,
             -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = {twiddles[16 + 2 * (thread % 16)].x,
             -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    InvRad3B1(&R[0], &R[1], &R[2]); /* stockham.py:566 */

    InvRad3B1(&R[3], &R[4], &R[5]); /* stockham.py:566 */

    InvRad3B1(&R[6], &R[7], &R[8]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 144 < 176)
    {
        InvRad3B1(&R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[2]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[5]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[8]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 144 < 176))
    {
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 3
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 48) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 96) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 144) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 192) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 240) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 288) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 336) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 384) * lstride]; /* stockham.py:542 */
    R[9]   = lds[offset_lds + (thread + 432) * lstride]; /* stockham.py:542 */
    R[10]  = lds[offset_lds + (thread + 480) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[47 + 10 * (thread % 48)].x,
         -twiddles[47 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[48 + 10 * (thread % 48)].x,
         -twiddles[48 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = {twiddles[49 + 10 * (thread % 48)].x,
         -twiddles[49 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */
    W      = {twiddles[50 + 10 * (thread % 48)].x,
         -twiddles[50 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = {twiddles[51 + 10 * (thread % 48)].x,
         -twiddles[51 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = {twiddles[52 + 10 * (thread % 48)].x,
         -twiddles[52 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = {twiddles[53 + 10 * (thread % 48)].x,
         -twiddles[53 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = {twiddles[54 + 10 * (thread % 48)].x,
         -twiddles[54 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */
    W      = {twiddles[55 + 10 * (thread % 48)].x,
         -twiddles[55 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
    t.y    = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
    R[9]   = t; /* stockham.py:557 */
    W      = {twiddles[56 + 10 * (thread % 48)].x,
         -twiddles[56 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
    t.y    = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
    R[10]  = t; /* stockham.py:557 */

    InvRad11B1(&R[0],
               &R[1],
               &R[2],
               &R[3],
               &R[4],
               &R[5],
               &R[6],
               &R[7],
               &R[8],
               &R[9],
               &R[10]); /* stockham.py:566 */

    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 48) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 96) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 144) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 192) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 240) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 288) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 336) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 384) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 432) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 480) * lstride]
            = R[10]; /* stockham.py:577 */
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__
    __launch_bounds__(48) void ip_inverse_length528_SBRR(const scalar_type* __restrict__ twiddles,
                                                         const size_t dim,
                                                         const size_t* __restrict__ lengths,
                                                         const size_t* __restrict__ stride,
                                                         const size_t       nbatch,
                                                         const unsigned int lds_padding,
                                                         void* __restrict__ load_cb_fn,
                                                         void* __restrict__ load_cb_data,
                                                         uint32_t load_cb_lds_bytes,
                                                         void* __restrict__ store_cb_fn,
                                                         void* __restrict__ store_cb_data,
                                                         scalar_type* __restrict__ buf)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset           = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0  = (sb == SB_UNIT) ? (1) : (stride[0]);
    auto         load_cb  = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset        = offset + index_along_d * stride[d]; /* stockham.py:370 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset     = offset + batch * stride[dim]; /* stockham.py:372 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf, offset + (thread + 0) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf, offset + (thread + 48) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf, offset + (thread + 96) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf, offset + (thread + 144) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf, offset + (thread + 192) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf, offset + (thread + 240) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf, offset + (thread + 288) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf, offset + (thread + 336) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf, offset + (thread + 384) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf, offset + (thread + 432) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf, offset + (thread + 480) * stride0, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = load_cb(buf, offset + (thread + 480 + 1) * stride0, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    ip_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(
        buf, offset + (thread + 0) * stride0, lds[offset_lds + thread + 0], store_cb_data, nullptr);
    store_cb(buf,
             offset + (thread + 48) * stride0,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 96) * stride0,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 144) * stride0,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 192) * stride0,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 240) * stride0,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 288) * stride0,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 336) * stride0,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 384) * stride0,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 432) * stride0,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf,
             offset + (thread + 480) * stride0,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf,
                     offset + (thread + 480 + 1) * stride0,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void ip_inverse_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ bufre,
    real_type_t<scalar_type>* __restrict__ bufim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset           = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0  = (sb == SB_UNIT) ? (1) : (stride[0]);
    auto         load_cb  = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset        = offset + index_along_d * stride[d]; /* stockham.py:370 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset     = offset + batch * stride[dim]; /* stockham.py:372 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread                       = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0] = {bufre[offset + (thread + 0) * stride0],
                                    bufim[offset + (thread + 0) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {bufre[offset + (thread + 48) * stride0],
           bufim[offset + (thread + 48) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {bufre[offset + (thread + 96) * stride0],
           bufim[offset + (thread + 96) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {bufre[offset + (thread + 144) * stride0],
           bufim[offset + (thread + 144) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {bufre[offset + (thread + 192) * stride0],
           bufim[offset + (thread + 192) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {bufre[offset + (thread + 240) * stride0],
           bufim[offset + (thread + 240) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {bufre[offset + (thread + 288) * stride0],
           bufim[offset + (thread + 288) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {bufre[offset + (thread + 336) * stride0],
           bufim[offset + (thread + 336) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {bufre[offset + (thread + 384) * stride0],
           bufim[offset + (thread + 384) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {bufre[offset + (thread + 432) * stride0],
           bufim[offset + (thread + 432) * stride0]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {bufre[offset + (thread + 480) * stride0],
           bufim[offset + (thread + 480) * stride0]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {bufre[offset + (thread + 480 + 1) * stride0],
                   bufim[offset + (thread + 480 + 1) * stride0]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    ip_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    bufre[offset + (thread + 0) * stride0] = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    bufim[offset + (thread + 0) * stride0] = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    bufre[offset + (thread + 48) * stride0]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    bufim[offset + (thread + 48) * stride0]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    bufre[offset + (thread + 96) * stride0]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    bufim[offset + (thread + 96) * stride0]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    bufre[offset + (thread + 144) * stride0]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    bufim[offset + (thread + 144) * stride0]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    bufre[offset + (thread + 192) * stride0]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    bufim[offset + (thread + 192) * stride0]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    bufre[offset + (thread + 240) * stride0]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    bufim[offset + (thread + 240) * stride0]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    bufre[offset + (thread + 288) * stride0]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    bufim[offset + (thread + 288) * stride0]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    bufre[offset + (thread + 336) * stride0]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    bufim[offset + (thread + 336) * stride0]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    bufre[offset + (thread + 384) * stride0]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    bufim[offset + (thread + 384) * stride0]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    bufre[offset + (thread + 432) * stride0]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    bufim[offset + (thread + 432) * stride0]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    bufre[offset + (thread + 480) * stride0]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    bufim[offset + (thread + 480) * stride0]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            bufre[offset + (thread + 480 + 1) * stride0]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            bufim[offset + (thread + 480 + 1) * stride0]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
/* stockham.py:843 */
template <typename scalar_type, StrideBin sb>
__device__ void op_inverse_length528_SBRR_device(scalar_type* __restrict__ lds,
                                                 const scalar_type* __restrict__ twiddles,
                                                 size_t       stride_lds,
                                                 unsigned int offset_lds,
                                                 bool         write)
{
    size_t       thread;
    scalar_type  R[22];
    scalar_type  W;
    scalar_type  t;
    const size_t lstride = (sb == SB_UNIT) ? (1) : (stride_lds);

    __syncthreads();

    // pass 0
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    InvRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    InvRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        InvRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 1) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 2) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 1) * 4 + thread % 1 + 3) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 1
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[4]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        R[8]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[9]  = lds[offset_lds + (thread + 132) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 264) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 396) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[3 + 3 * (thread % 4)].x,
         -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[4 + 3 * (thread % 4)].x,
         -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = {twiddles[5 + 3 * (thread % 4)].x,
         -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = {twiddles[3 + 3 * (thread % 4)].x,
         -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = {twiddles[4 + 3 * (thread % 4)].x,
         -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = {twiddles[5 + 3 * (thread % 4)].x,
         -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(threadIdx.x % 48 + 96 < 132)
    {
        W     = {twiddles[3 + 3 * (thread % 4)].x,
             -twiddles[3 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
        t.y   = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
        R[9]  = t; /* stockham.py:557 */
        W     = {twiddles[4 + 3 * (thread % 4)].x,
             -twiddles[4 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = {twiddles[5 + 3 * (thread % 4)].x,
             -twiddles[5 + 3 * (thread % 4)].y}; /* generator.py:1065 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    InvRad4B1(&R[0], &R[1], &R[2], &R[3]); /* stockham.py:566 */

    InvRad4B1(&R[4], &R[5], &R[6], &R[7]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 96 < 132)
    {
        InvRad4B1(&R[8], &R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[3]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[7]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 96 < 132))
    {
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 0) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 4) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 8) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 4) * 16 + thread % 4 + 12) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 2
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    R[3]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    R[6]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        R[9]  = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
        R[10] = lds[offset_lds + (thread + 176) * lstride]; /* stockham.py:542 */
        R[11] = lds[offset_lds + (thread + 352) * lstride]; /* stockham.py:542 */
    }
    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
    W      = {twiddles[15 + 2 * (thread % 16)].x,
         -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = {twiddles[16 + 2 * (thread % 16)].x,
         -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */

    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(threadIdx.x % 48 + 144 < 176)
    {
        W     = {twiddles[15 + 2 * (thread % 16)].x,
             -twiddles[15 + 2 * (thread % 16)].y}; /* generator.py:1065 */
        t.x   = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
        t.y   = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
        R[10] = t; /* stockham.py:557 */
        W     = {twiddles[16 + 2 * (thread % 16)].x,
             -twiddles[16 + 2 * (thread % 16)].y}; /* generator.py:1065 */
        t.x   = W.x * R[11].x - W.y * R[11].y; /* stockham.py:555 */
        t.y   = W.y * R[11].x + W.x * R[11].y; /* stockham.py:556 */
        R[11] = t; /* stockham.py:557 */
    }

    InvRad3B1(&R[0], &R[1], &R[2]); /* stockham.py:566 */

    InvRad3B1(&R[3], &R[4], &R[5]); /* stockham.py:566 */

    InvRad3B1(&R[6], &R[7], &R[8]); /* stockham.py:566 */

    if(threadIdx.x % 48 + 144 < 176)
    {
        InvRad3B1(&R[9], &R[10], &R[11]); /* stockham.py:566 */
    }
    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[2]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 48; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[5]; /* stockham.py:577 */
    }
    if(write)
    {
        thread = threadIdx.x % 48 + 96; /* stockham.py:787 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[8]; /* stockham.py:577 */
    }
    thread = threadIdx.x % 48 + 144; /* stockham.py:787 */
    if(write && (threadIdx.x % 48 + 144 < 176))
    {
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 0) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 16) * lstride]
            = R[10]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 16) * 48 + thread % 16 + 32) * lstride]
            = R[11]; /* stockham.py:577 */
    }

    // pass 3
    __syncthreads();

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    R[0]   = lds[offset_lds + (thread + 0) * lstride]; /* stockham.py:542 */
    R[1]   = lds[offset_lds + (thread + 48) * lstride]; /* stockham.py:542 */
    R[2]   = lds[offset_lds + (thread + 96) * lstride]; /* stockham.py:542 */
    R[3]   = lds[offset_lds + (thread + 144) * lstride]; /* stockham.py:542 */
    R[4]   = lds[offset_lds + (thread + 192) * lstride]; /* stockham.py:542 */
    R[5]   = lds[offset_lds + (thread + 240) * lstride]; /* stockham.py:542 */
    R[6]   = lds[offset_lds + (thread + 288) * lstride]; /* stockham.py:542 */
    R[7]   = lds[offset_lds + (thread + 336) * lstride]; /* stockham.py:542 */
    R[8]   = lds[offset_lds + (thread + 384) * lstride]; /* stockham.py:542 */
    R[9]   = lds[offset_lds + (thread + 432) * lstride]; /* stockham.py:542 */
    R[10]  = lds[offset_lds + (thread + 480) * lstride]; /* stockham.py:542 */

    thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
    W      = {twiddles[47 + 10 * (thread % 48)].x,
         -twiddles[47 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[1].x - W.y * R[1].y; /* stockham.py:555 */
    t.y    = W.y * R[1].x + W.x * R[1].y; /* stockham.py:556 */
    R[1]   = t; /* stockham.py:557 */
    W      = {twiddles[48 + 10 * (thread % 48)].x,
         -twiddles[48 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[2].x - W.y * R[2].y; /* stockham.py:555 */
    t.y    = W.y * R[2].x + W.x * R[2].y; /* stockham.py:556 */
    R[2]   = t; /* stockham.py:557 */
    W      = {twiddles[49 + 10 * (thread % 48)].x,
         -twiddles[49 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[3].x - W.y * R[3].y; /* stockham.py:555 */
    t.y    = W.y * R[3].x + W.x * R[3].y; /* stockham.py:556 */
    R[3]   = t; /* stockham.py:557 */
    W      = {twiddles[50 + 10 * (thread % 48)].x,
         -twiddles[50 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[4].x - W.y * R[4].y; /* stockham.py:555 */
    t.y    = W.y * R[4].x + W.x * R[4].y; /* stockham.py:556 */
    R[4]   = t; /* stockham.py:557 */
    W      = {twiddles[51 + 10 * (thread % 48)].x,
         -twiddles[51 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[5].x - W.y * R[5].y; /* stockham.py:555 */
    t.y    = W.y * R[5].x + W.x * R[5].y; /* stockham.py:556 */
    R[5]   = t; /* stockham.py:557 */
    W      = {twiddles[52 + 10 * (thread % 48)].x,
         -twiddles[52 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[6].x - W.y * R[6].y; /* stockham.py:555 */
    t.y    = W.y * R[6].x + W.x * R[6].y; /* stockham.py:556 */
    R[6]   = t; /* stockham.py:557 */
    W      = {twiddles[53 + 10 * (thread % 48)].x,
         -twiddles[53 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[7].x - W.y * R[7].y; /* stockham.py:555 */
    t.y    = W.y * R[7].x + W.x * R[7].y; /* stockham.py:556 */
    R[7]   = t; /* stockham.py:557 */
    W      = {twiddles[54 + 10 * (thread % 48)].x,
         -twiddles[54 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[8].x - W.y * R[8].y; /* stockham.py:555 */
    t.y    = W.y * R[8].x + W.x * R[8].y; /* stockham.py:556 */
    R[8]   = t; /* stockham.py:557 */
    W      = {twiddles[55 + 10 * (thread % 48)].x,
         -twiddles[55 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[9].x - W.y * R[9].y; /* stockham.py:555 */
    t.y    = W.y * R[9].x + W.x * R[9].y; /* stockham.py:556 */
    R[9]   = t; /* stockham.py:557 */
    W      = {twiddles[56 + 10 * (thread % 48)].x,
         -twiddles[56 + 10 * (thread % 48)].y}; /* generator.py:1065 */
    t.x    = W.x * R[10].x - W.y * R[10].y; /* stockham.py:555 */
    t.y    = W.y * R[10].x + W.x * R[10].y; /* stockham.py:556 */
    R[10]  = t; /* stockham.py:557 */

    InvRad11B1(&R[0],
               &R[1],
               &R[2],
               &R[3],
               &R[4],
               &R[5],
               &R[6],
               &R[7],
               &R[8],
               &R[9],
               &R[10]); /* stockham.py:566 */

    __syncthreads();
    if(write)
    {
        thread = threadIdx.x % 48 + 0; /* stockham.py:787 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 0) * lstride]
            = R[0]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 48) * lstride]
            = R[1]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 96) * lstride]
            = R[2]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 144) * lstride]
            = R[3]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 192) * lstride]
            = R[4]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 240) * lstride]
            = R[5]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 288) * lstride]
            = R[6]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 336) * lstride]
            = R[7]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 384) * lstride]
            = R[8]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 432) * lstride]
            = R[9]; /* stockham.py:577 */
        lds[offset_lds + ((thread / 48) * 528 + thread % 48 + 480) * lstride]
            = R[10]; /* stockham.py:577 */
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__
    __launch_bounds__(48) void op_inverse_length528_SBRR(const scalar_type* __restrict__ twiddles,
                                                         const size_t dim,
                                                         const size_t* __restrict__ lengths,
                                                         const size_t* __restrict__ stride_in,
                                                         const size_t* __restrict__ stride_out,
                                                         const size_t       nbatch,
                                                         const unsigned int lds_padding,
                                                         void* __restrict__ load_cb_fn,
                                                         void* __restrict__ load_cb_data,
                                                         uint32_t load_cb_lds_bytes,
                                                         void* __restrict__ store_cb_fn,
                                                         void* __restrict__ store_cb_data,
                                                         scalar_type* __restrict__ buf_in,
                                                         scalar_type* __restrict__ buf_out)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf_in, offset_in + (thread + 0) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf_in, offset_in + (thread + 48) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf_in, offset_in + (thread + 96) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf_in, offset_in + (thread + 144) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf_in, offset_in + (thread + 192) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf_in, offset_in + (thread + 240) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf_in, offset_in + (thread + 288) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf_in, offset_in + (thread + 336) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf_in, offset_in + (thread + 384) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf_in, offset_in + (thread + 432) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf_in, offset_in + (thread + 480) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1] = load_cb(
                buf_in, offset_in + (thread + 480 + 1) * stride0_in, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(buf_out,
             offset_out + (thread + 0) * stride0_out,
             lds[offset_lds + thread + 0],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 48) * stride0_out,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 96) * stride0_out,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 144) * stride0_out,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 192) * stride0_out,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 240) * stride0_out,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 288) * stride0_out,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 336) * stride0_out,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 384) * stride0_out,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 432) * stride0_out,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 480) * stride0_out,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf_out,
                     offset_out + (thread + 480 + 1) * stride0_out,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_inverse_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    scalar_type* __restrict__ buf_in,
    real_type_t<scalar_type>* __restrict__ buf_outre,
    real_type_t<scalar_type>* __restrict__ buf_outim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = load_cb(buf_in, offset_in + (thread + 0) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 48]
        = load_cb(buf_in, offset_in + (thread + 48) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 96]
        = load_cb(buf_in, offset_in + (thread + 96) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 144]
        = load_cb(buf_in, offset_in + (thread + 144) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 192]
        = load_cb(buf_in, offset_in + (thread + 192) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 240]
        = load_cb(buf_in, offset_in + (thread + 240) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 288]
        = load_cb(buf_in, offset_in + (thread + 288) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 336]
        = load_cb(buf_in, offset_in + (thread + 336) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 384]
        = load_cb(buf_in, offset_in + (thread + 384) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 432]
        = load_cb(buf_in, offset_in + (thread + 432) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */
    lds[offset_lds + thread + 480]
        = load_cb(buf_in, offset_in + (thread + 480) * stride0_in, load_cb_data, nullptr);
    ; /* stockham.py:387 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1] = load_cb(
                buf_in, offset_in + (thread + 480 + 1) * stride0_in, load_cb_data, nullptr);
            ; /* stockham.py:395 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    buf_outre[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            buf_outre[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            buf_outim[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_inverse_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ buf_inre,
    real_type_t<scalar_type>* __restrict__ buf_inim,
    scalar_type* __restrict__ buf_out)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = {buf_inre[offset_in + (thread + 0) * stride0_in],
           buf_inim[offset_in + (thread + 0) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {buf_inre[offset_in + (thread + 48) * stride0_in],
           buf_inim[offset_in + (thread + 48) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {buf_inre[offset_in + (thread + 96) * stride0_in],
           buf_inim[offset_in + (thread + 96) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {buf_inre[offset_in + (thread + 144) * stride0_in],
           buf_inim[offset_in + (thread + 144) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {buf_inre[offset_in + (thread + 192) * stride0_in],
           buf_inim[offset_in + (thread + 192) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {buf_inre[offset_in + (thread + 240) * stride0_in],
           buf_inim[offset_in + (thread + 240) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {buf_inre[offset_in + (thread + 288) * stride0_in],
           buf_inim[offset_in + (thread + 288) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {buf_inre[offset_in + (thread + 336) * stride0_in],
           buf_inim[offset_in + (thread + 336) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {buf_inre[offset_in + (thread + 384) * stride0_in],
           buf_inim[offset_in + (thread + 384) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {buf_inre[offset_in + (thread + 432) * stride0_in],
           buf_inim[offset_in + (thread + 432) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {buf_inre[offset_in + (thread + 480) * stride0_in],
           buf_inim[offset_in + (thread + 480) * stride0_in]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {buf_inre[offset_in + (thread + 480 + 1) * stride0_in],
                   buf_inim[offset_in + (thread + 480 + 1) * stride0_in]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    store_cb(buf_out,
             offset_out + (thread + 0) * stride0_out,
             lds[offset_lds + thread + 0],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 48) * stride0_out,
             lds[offset_lds + thread + 48],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 96) * stride0_out,
             lds[offset_lds + thread + 96],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 144) * stride0_out,
             lds[offset_lds + thread + 144],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 192) * stride0_out,
             lds[offset_lds + thread + 192],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 240) * stride0_out,
             lds[offset_lds + thread + 240],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 288) * stride0_out,
             lds[offset_lds + thread + 288],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 336) * stride0_out,
             lds[offset_lds + thread + 336],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 384) * stride0_out,
             lds[offset_lds + thread + 384],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 432) * stride0_out,
             lds[offset_lds + thread + 432],
             store_cb_data,
             nullptr);
    store_cb(buf_out,
             offset_out + (thread + 480) * stride0_out,
             lds[offset_lds + thread + 480],
             store_cb_data,
             nullptr);

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            store_cb(buf_out,
                     offset_out + (thread + 480 + 1) * stride0_out,
                     lds[offset_lds + thread + 480 + 1],
                     store_cb_data,
                     nullptr);
        }
    }
}
/* stockham.py:709 */
template <typename scalar_type, StrideBin sb, EmbeddedType ebtype, CallbackType cbtype>
__global__ __launch_bounds__(48) void op_inverse_length528_SBRR(
    const scalar_type* __restrict__ twiddles,
    const size_t dim,
    const size_t* __restrict__ lengths,
    const size_t* __restrict__ stride_in,
    const size_t* __restrict__ stride_out,
    const size_t       nbatch,
    const unsigned int lds_padding,
    void* __restrict__ load_cb_fn,
    void* __restrict__ load_cb_data,
    uint32_t load_cb_lds_bytes,
    void* __restrict__ store_cb_fn,
    void* __restrict__ store_cb_data,
    real_type_t<scalar_type>* __restrict__ buf_inre,
    real_type_t<scalar_type>* __restrict__ buf_inim,
    real_type_t<scalar_type>* __restrict__ buf_outre,
    real_type_t<scalar_type>* __restrict__ buf_outim)
{
    // this kernel:
    //   uses 48 threads per transform
    //   does 1 transforms per thread block
    // therefore it should be called with 48 threads per thread block
    extern __shared__ unsigned char __align__(sizeof(scalar_type)) lds_uchar[];
    scalar_type* __restrict__ lds = reinterpret_cast<scalar_type*>(lds_uchar);
    size_t       offset_in        = 0;
    size_t       offset_out       = 0;
    unsigned int offset_lds;
    size_t       stride_lds;
    size_t       batch;
    size_t       transform;
    size_t       thread;
    bool         write;
    const size_t stride0_in  = (sb == SB_UNIT) ? (1) : (stride_in[0]);
    const size_t stride0_out = (sb == SB_UNIT) ? (1) : (stride_out[0]);
    auto         load_cb     = get_load_cb<scalar_type, cbtype>(load_cb_fn);
    auto         store_cb    = get_store_cb<scalar_type, cbtype>(store_cb_fn);

    // large twiddles

    // offsets
    size_t remaining;
    size_t plength = 1;
    size_t index_along_d;
    transform = blockIdx.x * 1 + threadIdx.x / 48; /* stockham.py:363 */
    remaining = transform; /* stockham.py:364 */
    for(int d = 1; d < dim; ++d)
    {
        plength       = plength * lengths[d]; /* stockham.py:367 */
        index_along_d = remaining % lengths[d]; /* stockham.py:368 */
        remaining     = remaining / lengths[d]; /* stockham.py:369 */
        offset_in     = offset_in + index_along_d * stride_in[d]; /* generator.py:992 */
        offset_out    = offset_out + index_along_d * stride_out[d]; /* generator.py:993 */
    }
    batch      = transform / plength; /* stockham.py:371 */
    offset_in  = offset_in + batch * stride_in[dim]; /* generator.py:992 */
    offset_out = offset_out + batch * stride_out[dim]; /* generator.py:993 */
    offset_lds = (528 + lds_padding) * (transform % 1); /* stockham.py:373 */

    if(batch >= nbatch)
    {
        return;
    }

    // load global
    thread = threadIdx.x % 48; /* stockham.py:384 */
    lds[offset_lds + thread + 0]
        = {buf_inre[offset_in + (thread + 0) * stride0_in],
           buf_inim[offset_in + (thread + 0) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 48]
        = {buf_inre[offset_in + (thread + 48) * stride0_in],
           buf_inim[offset_in + (thread + 48) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 96]
        = {buf_inre[offset_in + (thread + 96) * stride0_in],
           buf_inim[offset_in + (thread + 96) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 144]
        = {buf_inre[offset_in + (thread + 144) * stride0_in],
           buf_inim[offset_in + (thread + 144) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 192]
        = {buf_inre[offset_in + (thread + 192) * stride0_in],
           buf_inim[offset_in + (thread + 192) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 240]
        = {buf_inre[offset_in + (thread + 240) * stride0_in],
           buf_inim[offset_in + (thread + 240) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 288]
        = {buf_inre[offset_in + (thread + 288) * stride0_in],
           buf_inim[offset_in + (thread + 288) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 336]
        = {buf_inre[offset_in + (thread + 336) * stride0_in],
           buf_inim[offset_in + (thread + 336) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 384]
        = {buf_inre[offset_in + (thread + 384) * stride0_in],
           buf_inim[offset_in + (thread + 384) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 432]
        = {buf_inre[offset_in + (thread + 432) * stride0_in],
           buf_inim[offset_in + (thread + 432) * stride0_in]}; /* generator.py:872 */
    lds[offset_lds + thread + 480]
        = {buf_inre[offset_in + (thread + 480) * stride0_in],
           buf_inim[offset_in + (thread + 480) * stride0_in]}; /* generator.py:872 */

    // append extra global loading for C2Real pre-process only
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        // use the last thread of each transform to load one more element per row
        if(thread == 47)
        {
            lds[offset_lds + thread + 480 + 1]
                = {buf_inre[offset_in + (thread + 480 + 1) * stride0_in],
                   buf_inim[offset_in + (thread + 480 + 1) * stride0_in]}; /* generator.py:872 */
        }
    }

    // handle even-length real to complex pre-process in lds before transform
    if(ebtype == EmbeddedType::C2Real_PRE)
    {
        __syncthreads();

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                           528 - thread % 264 - 0,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                           528 - thread % 264 - 48,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                           528 - thread % 264 - 96,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                           528 - thread % 264 - 144,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                           528 - thread % 264 - 192,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        real_pre_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                           528 - thread % 264 - 240,
                                                           264,
                                                           &lds[offset_lds],
                                                           0,
                                                           &twiddles[528]); /* stockham.py:338 */

        __syncthreads();
    }

    // transform
    write = true; /* stockham.py:681 */
    op_inverse_length528_SBRR_device<scalar_type, SB_UNIT>(
        lds, twiddles, stride_lds, offset_lds, write); /* stockham.py:686 */

    // handle even-length complex to real post-process in lds after transform
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        __syncthreads();

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 0,
                                                            528 - thread % 264 - 0,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 48,
                                                            528 - thread % 264 - 48,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 96,
                                                            528 - thread % 264 - 96,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 144,
                                                            528 - thread % 264 - 144,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 192,
                                                            528 - thread % 264 - 192,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */

        real_post_process_kernel_inplace<scalar_type, true>(thread % 264 + 240,
                                                            528 - thread % 264 - 240,
                                                            264,
                                                            &lds[offset_lds],
                                                            0,
                                                            &twiddles[528]); /* stockham.py:338 */
    }

    // store global
    __syncthreads();
    buf_outre[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 0) * stride0_out]
        = lds[offset_lds + thread + 0].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 48) * stride0_out]
        = lds[offset_lds + thread + 48].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 96) * stride0_out]
        = lds[offset_lds + thread + 96].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 144) * stride0_out]
        = lds[offset_lds + thread + 144].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 192) * stride0_out]
        = lds[offset_lds + thread + 192].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 240) * stride0_out]
        = lds[offset_lds + thread + 240].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 288) * stride0_out]
        = lds[offset_lds + thread + 288].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 336) * stride0_out]
        = lds[offset_lds + thread + 336].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 384) * stride0_out]
        = lds[offset_lds + thread + 384].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 432) * stride0_out]
        = lds[offset_lds + thread + 432].y; /* generator.py:908 */
    buf_outre[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].x; /* generator.py:906 */
    buf_outim[offset_out + (thread + 480) * stride0_out]
        = lds[offset_lds + thread + 480].y; /* generator.py:908 */

    // append extra global write for Real2C post-process only
    if(ebtype == EmbeddedType::Real2C_POST)
    {
        // use the last thread of each transform to write one more element per row
        if(thread == 47)
        {
            buf_outre[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].x; /* generator.py:906 */
            buf_outim[offset_out + (thread + 480 + 1) * stride0_out]
                = lds[offset_lds + thread + 480 + 1].y; /* generator.py:908 */
        }
    }
}
POWX_SMALL_GENERATOR(rocfft_internal_dfn_dp_ci_ci_stoc_528,
                     ip_forward_length528_SBRR,
                     ip_inverse_length528_SBRR,
                     op_forward_length528_SBRR,
                     op_inverse_length528_SBRR,
                     double2);
POWX_SMALL_GENERATOR(rocfft_internal_dfn_sp_ci_ci_stoc_528,
                     ip_forward_length528_SBRR,
                     ip_inverse_length528_SBRR,
                     op_forward_length528_SBRR,
                     op_inverse_length528_SBRR,
                     float2);